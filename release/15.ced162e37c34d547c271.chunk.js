webpackJsonp([15],{"6oSf":function(e,t,n){"use strict";var o=n("IekC"),r=n("BkNc"),a=n("ge1L");n.n(a);n.d(t,"a",function(){return c});var c=function(){function e(e,t,n){this.router=e,this.appHttpService=t,this.uc=n,this.now=1,this.plugins={},this.moreCondition=!1,this.searchBy={order_no:""},this.getGridData=function(e){var t=this;this.appHttpService.postData(this.uc.api.qc+"/get_charge_card_record_list",{params:e}).subscribe(function(n){if(n.status){var o=n.data,r=o.list;t.plugins.grid.pagination.totalItems=o.total_num,t.plugins.grid.tbody=[];for(var a=0,c=r;a<c.length;a++){var i=c[a],s=void 0;s=[{content:i.order_id,hidden:!0},{content:i.order_no},{content:i.card_no},{content:i.business_name},{content:i.device_no},{content:i.device_name},{content:i.app_user_name},{content:i.order_sum},{content:i.pay_type_name},{content:i.trade_no},{content:i.payee_business_name},{content:i.order_status_name},{content:i.payee_type_name},{content:i.create_time}];var l=[];!t.uc.powerfun(t.uc.constant.order_finish)||"6"!=i.order_status&&"4"!=i.order_status||l.push({content:"完成",class:"btn-success",click:function(n){var o=n[0].content;swal({title:"确定完成?",text:"",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,confirmButtonColor:"#DD6B55"}).then(function(n){!0===n&&t.appHttpService.postData(t.uc.api.qc+"/card_order_finish/",{params:{order_id:o}}).subscribe(function(n){n.status?(swal({title:"完成成功!",text:"",type:"success",timer:"2000"}),t.getGridData(e)):swal("完成失败!",n.error_msg,"error")})},function(){})}}),!t.uc.powerfun(t.uc.constant.order_refund)||"6"!=i.order_status&&"4"!=i.order_status||l.push({content:"退费",class:"btn-warning",click:function(n){var o=n[0].content;swal({title:"确定退费?",text:"",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,confirmButtonColor:"#DD6B55"}).then(function(n){!0===n&&t.appHttpService.postData(t.uc.api.qc+"/card_order_refund/",{params:{order_id:o}}).subscribe(function(n){n.status?(swal({title:"退费成功!",text:"",type:"success",timer:"2000"}),t.getGridData(e)):swal("退费失败!",n.error_msg,"error")})},function(){})}}),s.push({type:"operation",operation:l}),t.plugins.grid.tbody.push(s)}}else swal({title:"获取充卡信息失败!",text:n.error_msg,type:"error",timer:"2000"})})}}return e.prototype.ngOnInit=function(){var e=this;this.plugins.grid={th:[{content:"订单ID",hidden:!0},{content:"充值单号"},{content:"充值卡号"},{content:"商家"},{content:"设备号"},{content:"设备名称"},{content:"用户"},{content:"金额"},{content:"支付方式"},{content:"支付单号"},{content:"收款账号"},{content:"订单状态"},{content:"结算方式"},{content:"创建时间"},{content:"操作"}],tbody:[],pagination:{maxSize:5,itemsPerPage:20,currentPage:1,totalItems:1}},this.plugins.search=[{title:"开始时间",key:"start_time",controlType:"time",value:"",config:{showTimePicker:!1,format:0},placeholder:"请点击选择日期"},{title:"结束时间",key:"end_time",controlType:"time",value:"",config:{showTimePicker:!1,format:0},placeholder:"请点击选择日期"},{title:"充值单号",key:"order_no",controlType:"input",value:"",placeholder:"请输入充值单号"},{title:"充值卡号",key:"card_no",controlType:"input",value:"",placeholder:"请输入充值卡号"},{title:"充值状态",key:"order_status",controlType:"select",value:"0",placeholder:"请选择充值状态",options:[{name:"已完成",geo_id:"2"},{name:"已退费",geo_id:"3"},{name:"充值中",geo_id:"6"}]},{title:"机构名称",key:"business_name",controlType:"input",value:"",hidden:!0,placeholder:"请输入机构名称"},{title:"机构类型",key:"business_type",controlType:"select",value:"0",hidden:!0,placeholder:"请选择机构类型",options:[{name:"代理商",geo_id:"代理商"},{name:"城市合伙人",geo_id:"城市合伙人"},{name:"商户",geo_id:"商户"}]},{title:"设备名称",key:"device_name",controlType:"input",value:"",hidden:!0,placeholder:"请输入设备名称"},{title:"设备小区",key:"areas_name",controlType:"input",value:"",hidden:!0,placeholder:"请输入设备小区名称"},{title:"机构地址",key:"business_address",controlType:"address",hasChildGroup:!0,hidden:!0,url:this.uc.api.qc+"/get_geo_list/",config:{province:{name:"province_code",value:"0",placeholder:"--请选择省--"},city:{name:"city_code",value:"0",placeholder:"--请选择市--"},area:{name:"district_code",value:"0",placeholder:"--请选择区--"}}},{title:"设备地址",key:"device_address",controlType:"address",hasChildGroup:!0,hidden:!0,url:this.uc.api.qc+"/get_geo_list/",config:{province:{name:"province_code",value:"0",placeholder:"--请选择省--"},city:{name:"city_code",value:"0",placeholder:"--请选择市--"},area:{name:"district_code",value:"0",placeholder:"--请选择区--"}}}],this.plugins.buttons=[{type:"notform",class:"btn-success",content:"展开条件",click:function(){if(e.moreCondition=!e.moreCondition,e.moreCondition){e.plugins.buttons[0].content="收起条件";for(var t=5;t<e.plugins.search.length;t++)e.plugins.search[t].hidden=!1}else{e.plugins.buttons[0].content="展开条件";for(var t=5;t<e.plugins.search.length;t++)e.plugins.search[t].hidden=!0}}},{type:"form",class:"btn-primary",content:"搜索",click:function(t){var n=(void 0===t?{value:n}:t).value,o=n.order_no,r=n.card_no,c=n.order_status,i=n.start_time,s=n.end_time,l=n.device_name,d=n.business_name,u=n.areas_name,p=n.business_type,m=n.device_address,_=n.business_address;return i&&!s||!i&&s?void swal({title:"提示!",text:"开始时间和结束时间要一起填写",type:"error",timer:"2000"}):i>s?void swal({title:"提示!",text:"开始时间不能大开结束时间",type:"error",timer:"2000"}):(e.searchBy={order_no:o?o.trim():"",card_no:r?r.trim():"",order_status:c,start_time:i?a(i).format("YYYY-MM-DD 00:00:00"):"",end_time:s?a(s).format("YYYY-MM-DD 23:59:59"):"",device_name:l?l.trim():"",business_name:d?d.trim():"",device:{areas_name:u?u.trim():"",province_code:m.province_code,city_code:m.city_code,district_code:m.district_code},user:{busiess_type:p,province_code:_.province_code,city_code:_.city_code,district_code:_.district_code}},e.now=1,void e.getGridData({page_now:e.now,limit:20,sort_by:"create_time",sort_type:"desc",search_by:e.searchBy}))}},{type:"form",class:"btn-info",content:"导出",click:function(t){var n=(void 0===t?{value:n}:t).value;e.downloadTemplate(e.searchBy)}},{type:"reset",class:"btn-danger",content:"重置",click:function(){e.searchBy={order_no:""},e.now=1,e.getGridData({page_now:e.now,limit:20,sort_by:"create_time",sort_type:"desc",search_by:e.searchBy})}}],this.getGridData({page_now:this.now,limit:20,sort_by:"create_time",sort_type:"desc",search_by:{}})},e.prototype.pageBeChanged=function(e){this.getGridData({page_now:e.page,limit:e.itemsPerPage,sort_by:"create_time",sort_type:"desc",search_by:this.searchBy})},e.prototype.downloadTemplate=function(e){this.appHttpService.getBinary(this.uc.api.qc+"/download_card_info/",{params:e}).subscribe(function(e){var t=e.headers._headers.get("content-disposition");if(t){var n=new Blob([e._body],{type:"application/vnd.ms-excel"}),o=URL.createObjectURL(n),r=document.createElement("a"),a=t[0].split(";")[1].trim().split("=")[1];try{a=JSON.parse(a)}catch(e){console.log(e)}document.body.appendChild(r),r.setAttribute("style","display:none"),r.setAttribute("href",o),r.setAttribute("download",a),r.click(),URL.revokeObjectURL(o)}else swal("下载失败",e.error_msg,"error")})},e.ctorParameters=function(){return[{type:r.c},{type:o.a},{type:o.b}]},e}()},NK3V:function(e,t,n){"use strict";function o(e){return c["ɵvid"](0,[(e()(),c["ɵeld"](0,null,null,1,"uc-search",[],null,null,null,i.a,i.b)),c["ɵdid"](638976,null,0,s.a,[],{searchData:[0,"searchData"],buttons:[1,"buttons"]},null),(e()(),c["ɵted"](null,["\n"])),(e()(),c["ɵeld"](0,null,null,1,"uc-table",[],null,[[null,"pageBeChanged"]],function(e,t,n){var o=!0,r=e.component;if("pageBeChanged"===t){o=!1!==r.pageBeChanged(n)&&o}return o},d.a,d.b)),c["ɵdid"](114688,null,0,u.a,[],{model:[0,"model"]},{pageBeChanged:"pageBeChanged"})],function(e,t){var n=t.component;e(t,1,0,n.plugins.search,n.plugins.buttons),e(t,4,0,n.plugins.grid)},null)}function r(e){return c["ɵvid"](0,[(e()(),c["ɵeld"](0,null,null,1,"rechargecardrecord-list",[],null,null,null,o,f)),c["ɵdid"](114688,null,0,l.a,[p.c,m.a,_.a],null,null)],function(e,t){e(t,1,0)},null)}var a=n("hYRJ"),c=n("/oeL"),i=n("gSne"),s=n("XGh0"),l=n("6oSf"),d=n("tvCx"),u=n("sQer"),p=n("BkNc"),m=n("0kYB"),_=n("U9zq");n.d(t,"a",function(){return y});var h=[a.a],f=c["ɵcrt"]({encapsulation:0,styles:h,data:{}}),y=c["ɵccf"]("rechargecardrecord-list",l.a,r,{},{},[])},bcSC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),r=n("vlwo"),a=n("URzX"),c=n("s3h3"),i=n("NK3V"),s=n("qbdv"),l=n("bm2B"),d=n("dWcS"),u=n("W5fO"),p=n("qCSQ"),m=n("BkNc"),_=n("eJnt"),h=n("X/HD"),f=n("0Zl/"),y=n("y8ct"),g=n("c7oz"),v=n("6oSf");n.d(t,"rechargeCardModuleNgFactory",function(){return b});var b=o["ɵcmf"](r.a,[],function(e){return o["ɵmod"]([o["ɵmpd"](512,o.ComponentFactoryResolver,o["ɵCodegenComponentFactoryResolver"],[[8,[a.a,c.a,i.a]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o["ɵmpd"](4608,s.a,s.b,[o.LOCALE_ID]),o["ɵmpd"](4608,l.FormBuilder,l.FormBuilder,[]),o["ɵmpd"](4608,l["ɵi"],l["ɵi"],[]),o["ɵmpd"](4608,d.a,d.a,[]),o["ɵmpd"](4608,u.a,u.a,[]),o["ɵmpd"](4608,p.a,p.a,[]),o["ɵmpd"](512,m.x,m.x,[[2,m.m],[2,m.c]]),o["ɵmpd"](512,s.c,s.c,[]),o["ɵmpd"](512,l["ɵba"],l["ɵba"],[]),o["ɵmpd"](512,l.ReactiveFormsModule,l.ReactiveFormsModule,[]),o["ɵmpd"](512,_.a,_.a,[]),o["ɵmpd"](512,l.FormsModule,l.FormsModule,[]),o["ɵmpd"](512,h.a,h.a,[]),o["ɵmpd"](512,f.a,f.a,[]),o["ɵmpd"](512,y.a,y.a,[]),o["ɵmpd"](512,r.a,r.a,[]),o["ɵmpd"](1024,m.t,function(){return[[{path:"",component:g.a,children:[{path:"",redirectTo:"rechargeCardRecord",pathMatch:"full"},{path:"rechargeCardRecord",component:v.a}]}]]},[])])})},c7oz:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(){function e(){}return e.prototype.ngOnInit=function(){},e.ctorParameters=function(){return[]},e}()},hYRJ:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=["[_nghost-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}"]},s3h3:function(e,t,n){"use strict";function o(e){return a["ɵvid"](0,[(e()(),a["ɵeld"](16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),a["ɵdid"](212992,null,0,c.y,[c.q,a.ViewContainerRef,a.ComponentFactoryResolver,[8,null],a.ChangeDetectorRef],null,null)],function(e,t){e(t,1,0)},null)}function r(e){return a["ɵvid"](0,[(e()(),a["ɵeld"](0,null,null,1,"recharge-card",[],null,null,null,o,l)),a["ɵdid"](114688,null,0,i.a,[],null,null)],function(e,t){e(t,1,0)},null)}var a=n("/oeL"),c=n("BkNc"),i=n("c7oz");n.d(t,"a",function(){return d});var s=[],l=a["ɵcrt"]({encapsulation:2,styles:s,data:{}}),d=a["ɵccf"]("recharge-card",i.a,r,{},{},[])},vlwo:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(){function e(){}return e}()}});